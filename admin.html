<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard | Blog-Sphere</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    :root {
      --primary: #e74c3c;
      --dark: #1f2933;
      --light: #f5f7fa;
    }

    body {
      background: var(--light);
    }

    .admin-layout {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar */
    .admin-sidebar {
      width: 260px;
      background: var(--dark);
      color: #fff;
      padding: 30px 0;
    }

    .admin-sidebar h2 {
      text-align: center;
      margin-bottom: 40px;
      font-size: 1.8rem;
      color: var(--primary);
    }

    .admin-sidebar a {
      display: block;
      padding: 15px 30px;
      color: #cbd5e1;
      text-decoration: none;
      transition: 0.3s;
    }

    .admin-sidebar a:hover,
    .admin-sidebar a.active {
      background: var(--primary);
      color: #fff;
    }

    /* Main */
    .admin-main {
      flex: 1;
      padding: 30px 40px;
    }

    .admin-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .admin-top h1 {
      font-size: 2rem;
    }

    .logout-btn {
      background: var(--primary);
      border: none;
      color: #fff;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
    }

    /* Cards */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .card {
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    .card h3 {
      color: #555;
      margin-bottom: 8px;
    }

    .card span {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--primary);
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    th, td {
      padding: 15px;
      border-bottom: 1px solid #eee;
      text-align: left;
    }

    th {
      background: #f1f1f1;
    }

    .btn {
      padding: 6px 12px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
    }

    .delete {
      background: #e74c3c;
      color: #fff;
    }

    .edit {
      background: #3498db;
      color: #fff;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<script>
  const user = JSON.parse(localStorage.getItem('currentUser'));
  if (!user || user.role !== 'admin') {
    alert('Access denied');
    window.location.href = 'login.html';
  }
</script>

<div class="admin-layout">

  <aside class="admin-sidebar">
    <h2>Blog-Sphere</h2>
    <a href="#" class="active" onclick="showSection('dashboard')">Dashboard</a>
    <a href="#" onclick="showSection('blogs')">Manage Blogs</a>
    <a href="#" onclick="showSection('users')">Manage Users</a>
    <a href="#" onclick="showSection('settings')">Settings</a>
  </aside>

  <main class="admin-main">
    <div class="admin-top">
      <h1 id="pageTitle">Dashboard</h1>
      <button class="logout-btn" onclick="logout()">Logout</button>
    </div>

    <!-- Dashboard -->
    <section id="dashboard">
      <div class="cards">
        <div class="card"><h3>Total Users</h3><span id="userCount">0</span></div>
        <div class="card"><h3>Total Blogs</h3><span id="blogCount">0</span></div>
      </div>
    </section>

    <!-- Blogs -->
    <section id="blogs" class="hidden">
      <div class="card" style="margin-bottom:25px;">
        <h3>Add New Blog</h3><br>
        <input type="text" id="blogTitle" placeholder="Blog title" style="width:100%;padding:10px;margin-bottom:10px;">
        <textarea id="blogContent" placeholder="Blog content" rows="5" style="width:100%;padding:10px;margin-bottom:10px;"></textarea>
        <button class="btn edit" onclick="addBlog()">Publish Blog</button>
      </div>

      <table>
        <thead>
          <tr><th>Title</th><th>Author</th><th>Actions</th></tr>
        </thead>
        <tbody id="blogTable"></tbody>
      </table>
    </section>

    <!-- Users -->
    <section id="users" class="hidden">
      <table>
        <thead>
          <tr><th>Email</th><th>Role</th><th>Actions</th></tr>
        </thead>
        <tbody id="userTable"></tbody>
      </table>
    </section>

    <!-- Settings -->
    <section id="settings" class="hidden">
      <div class="card">
        <h3>Site Name</h3>
        <input type="text" id="siteName" value="Blog-Sphere" />
        <br><br>
        <button class="btn edit" onclick="saveSettings()">Save</button>
      </div>
    </section>
  </main>
</div>

<script>
  /* ===== INITIAL BLOG SEED (RUNS ONCE) ===== */
  if (!localStorage.getItem("blogs")) {
    const blogs = [
      {
        title: "How to Start Coding",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 05, 2025"
      },
      {
        title: "The Future of AI",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 10, 2025"
      },
      {
        title: "Cybersecurity Basics",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 12, 2025"
      },
      {
        title: "Web Dev Roadmap",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 15, 2025"
      },
      {
        title: "Mastering Python",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 18, 2025"
      },
      {
        title: "Understanding Blockchain",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 20, 2025"
      },
      {
        title: "Data Science Trends in 2025",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 22, 2025"
      },
      {
        title: "Getting Started with DevOps",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 25, 2025"
      },
      {
        title: "Cloud Computing Explained",
        content: "Your content here...",
        author: "Admin",
        date: "Jan 28, 2025"
      }
    ];

    localStorage.setItem("blogs", JSON.stringify(blogs));
  }

  /* ===== EXISTING ADMIN JS CONTINUES BELOW ===== */
</script>

<script>
  let users = JSON.parse(localStorage.getItem('users')) || [];
  let blogs = JSON.parse(localStorage.getItem('blogs')) || [];

  function showSection(id) {
    document.querySelectorAll('main section').forEach(s => s.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
    document.getElementById('pageTitle').textContent =
      id.charAt(0).toUpperCase() + id.slice(1);
    document.querySelectorAll('.admin-sidebar a').forEach(a => a.classList.remove('active'));
    event.target.classList.add('active');
  }

  function renderStats() {
    document.getElementById('userCount').textContent = users.length;
    document.getElementById('blogCount').textContent = blogs.length;
  }

  function renderUsers() {
    const table = document.getElementById('userTable');
    table.innerHTML = '';
    users.forEach((u, i) => {
      table.innerHTML += `
        <tr>
          <td>${u.email}</td>
          <td>${u.role}</td>
          <td><button class="btn delete" onclick="deleteUser(${i})">Delete</button></td>
        </tr>`;
    });
  }

  function renderBlogs() {
    const table = document.getElementById("blogTable");
    table.innerHTML = "";

    if (blogs.length === 0) {
      table.innerHTML = `<tr><td colspan="3">No blogs yet</td></tr>`;
      return;
    }

    blogs.forEach((b, i) => {
      table.innerHTML += `
        <tr>
          <td>${b.title}</td>
          <td>${b.author}</td>
          <td>
            <button class="btn edit" onclick="viewBlog(${i})">View</button>
            <button class="btn delete" onclick="deleteBlog(${i})">Delete</button>
          </td>
        </tr>`;
    });
  }

  /* âœ… VIEW BLOG (FIXED POSITION) */
  function viewBlog(index) {
    const blog = blogs[index];
    alert(`
Title: ${blog.title}

Author: ${blog.author}
Date: ${blog.date}

--------------------

${blog.content}
    `);
  }

  function addBlog() {
    const title = document.getElementById('blogTitle').value.trim();
    const content = document.getElementById('blogContent').value.trim();

    if (!title || !content) {
      alert('Please fill all fields');
      return;
    }

    blogs.push({
      title,
      content,
      author: 'Admin',
      date: new Date().toLocaleDateString()
    });

    localStorage.setItem('blogs', JSON.stringify(blogs));

    document.getElementById('blogTitle').value = '';
    document.getElementById('blogContent').value = '';

    renderBlogs();
    renderStats();
    alert('Blog published successfully');
  }

  function deleteUser(i) {
    if (confirm('Delete user?')) {
      users.splice(i, 1);
      localStorage.setItem('users', JSON.stringify(users));
      renderUsers();
      renderStats();
    }
  }

  function deleteBlog(i) {
    if (confirm('Delete blog?')) {
      blogs.splice(i, 1);
      localStorage.setItem('blogs', JSON.stringify(blogs));
      renderBlogs();
      renderStats();
    }
  }

  function logout() {
    localStorage.clear();
    sessionStorage.clear();
    window.location.href = 'login.html';
  }

  renderStats();
  renderUsers();
  renderBlogs();
</script>


</body>
</html>
